            </div>
        </main>
    </div>
    <script nonce="<%= cspNonce %>">
    window.__CSRF_TOKEN = '<%= csrfToken %>';
    (function() {
        function ensureFormToken(form) {
            if (!form) {
                return;
            }
            var method = (form.getAttribute('method') || 'GET').toUpperCase();
            if (method === 'GET') {
                return;
            }
            if (form.querySelector('input[name=\"_csrf\"]')) {
                return;
            }
            var tokenInput = document.createElement('input');
            tokenInput.type = 'hidden';
            tokenInput.name = '_csrf';
            tokenInput.value = window.__CSRF_TOKEN;
            form.appendChild(tokenInput);

            // multipart forms are parsed by multer later in the chain, so put token in query too.
            var enctype = (form.getAttribute('enctype') || '').toLowerCase();
            if (enctype.indexOf('multipart/form-data') !== -1) {
                try {
                    var action = form.getAttribute('action') || window.location.pathname;
                    var url = new URL(action, window.location.origin);
                    if (!url.searchParams.get('_csrf')) {
                        url.searchParams.set('_csrf', window.__CSRF_TOKEN);
                        form.setAttribute('action', url.pathname + url.search);
                    }
                } catch (e) {
                    // no-op
                }
            }
        }

        function initAdminFormsAndUi() {
            document.querySelectorAll('form').forEach(ensureFormToken);

            document.querySelectorAll('form[data-confirm]').forEach(function(form) {
                form.addEventListener('submit', function(event) {
                    var message = form.getAttribute('data-confirm') || 'Are you sure?';
                    if (!window.confirm(message)) {
                        event.preventDefault();
                    }
                });
            });

            document.querySelectorAll('[data-toggle-target]').forEach(function(btn) {
                btn.addEventListener('click', function() {
                    var targetId = btn.getAttribute('data-toggle-target');
                    var action = btn.getAttribute('data-toggle-action');
                    var target = document.getElementById(targetId);
                    if (!target) {
                        return;
                    }
                    if (action === 'show') {
                        target.style.display = 'block';
                    } else if (action === 'hide') {
                        target.style.display = 'none';
                    }
                });
            });

            document.querySelectorAll('[data-auto-submit=\"true\"]').forEach(function(input) {
                input.addEventListener('change', function() {
                    if (input.form) {
                        input.form.requestSubmit();
                    }
                });
            });
        }

        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', initAdminFormsAndUi);
        } else {
            initAdminFormsAndUi();
        }

        var originalFetch = window.fetch;
        window.fetch = function(resource, options) {
            var nextOptions = options ? Object.assign({}, options) : {};
            nextOptions.method = (nextOptions.method || 'GET').toUpperCase();
            if (['POST', 'PUT', 'PATCH', 'DELETE'].includes(nextOptions.method)) {
                var headers = new Headers(nextOptions.headers || {});
                if (!headers.has('CSRF-Token')) {
                    headers.set('CSRF-Token', window.__CSRF_TOKEN);
                }
                nextOptions.headers = headers;
            }
            return originalFetch(resource, nextOptions);
        };
    })();
    </script>
    <script nonce="<%= cspNonce %>" src="/js/admin.js"></script>
</body>
</html>




